<!DOCTYPE html>
<html lang="en">
  {% include head.html %}
  <body>
    {% include particles.html %}

    <style>
        #particles-js {
            background-color: transparent;
            opacity: 0;
            transition: 
                background-color 1.5s ease,
                opacity 2s ease;
        }

        .show_background {
            background-color: #151720 !important;
        }

        #overlay_text_wrapper {
            z-index: 1;
            text-align: center;
            color: #fff;
            position: absolute;
            top: 50%;
            left: 50%;
            margin: 0 auto;
            -webkit-transform: translate(-50%, -50%);
            transform: translate(-50%, -50%);
            opacity: 0;
            transition: 
                top 1.5s ease,
                opacity 1s ease;
        }

        #overlay_text {
            width: 100%;
            max-width: fit-content;
            max-height: 100px;
            word-break: break-all;
            transition: width 1.5s linear;
        }

        .hide_text {
            width: 0 !important;
        }

        .text_position_top {
            top: 150px !important;
        }

        #title-wrap {
            font-size: 100px;
            line-height: 100px;
            min-width: 2500px;
        }

        #cursor {
            bottom: 22px;
            margin-left: 40px;
            animation: 
                cursor_blink 1.5s steps(1) infinite both,
                rgb_text_bigger 2s steps(9) infinite alternate;
        }

        .rgb_text_bigger {
            animation: rgb_text_bigger 2s steps(9) infinite alternate;
        }

        #overlay_cam {
            background: white url(/assets/image/static.webp);
            background-size: cover;
            background-repeat: no-repeat;
            width: 1920px;
            height: 1080px;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            bottom: -1110px;
            overflow: hidden;
            border: white solid 10px;
            animation: rgb_box 2s steps(9) infinite alternate;
            transition: bottom 1.5s ease;
        }

        .show_cam {
            bottom: 50px !important;
        }

        .opacity {
            opacity: 1 !important;
        }

        @keyframes rgb_text_bigger {
            0%   { text-shadow: 2px 0 2px red, -2px 2px 2px lime, 0 0 cyan; }
            25%  { text-shadow: 0px -2px 2px red, 2px 2px 2px lime, -2px 0 2px cyan; }
            50%  { text-shadow: -2px 0 2px red, 2px -2px 2px lime, 2px 0 2px cyan; }
            75%  { text-shadow: 0px 2px 2px red, -2px -2px 2px lime, 0 0 cyan; }
            100% { text-shadow: 2px 0 2px red, 0 0 lime, -2px 2px 2px cyan; }
        }

        @keyframes rgb_box {
            0%   { box-shadow: 2px 0 2px red, -2px 2px 2px lime, 0 0 cyan; }
            25%  { box-shadow: 0px -2px 2px red, 2px 2px 2px lime, -2px 0 2px cyan; }
            50%  { box-shadow: -2px 0 2px red, 2px -2px 2px lime, 2px 0 2px cyan; }
            75%  { box-shadow: 0px 2px 2px red, -2px -2px 2px lime, 0 0 cyan; }
            100% { box-shadow: 2px 0 2px red, 0 0 lime, -2px 2px 2px cyan; }
        }

        @keyframes cursor_blink {
            0% { opacity: 0; }
            50% { opacity: 1; }
        }

    </style>
    <div id="warning" style="display:none;">
      <p>Load this page into an OBS-Studio Browser Source</p>
      <p>
        Width: 2560<br/>
        Height 1440<br/>
        Page permissions: Read access to user Information
      </p>
      <p>
        Create Scene Transitions (any settings):<br />
        Starting_Soon<br/>
        Be_Right_Back<br/>
        Stream_Ending<br/>
        Show_BG<br/>
        Hide_BG<br/>
        Show_Particles<br/>
        Hide_Particles<br/>
        Show_Cam<br/>
        Hide_Cam<br/>
        Show_Text<br/>
        Hide_Text<br/>
        Show_Text_Opacity<br/>
        Hide_Text_Opacity
      </p>
      <p>
        Toggle a Scene Transition to animate..<br/>
        Can use Stream Deck with the OBS Studio plugin.
      </p>
    </div>

    <div id="overlay_text_wrapper">
        <div id="title-wrap">
            <span id="greaterthan" class="rgb_text_bigger">&gt;</span>
            <span id="overlay_text" class="rgb_text_bigger">STARTING SOON</span>
            <span id="cursor">â–‹</span>
        </div>
    </div>
    <div id="overlay_cam">
        &nbsp;
    </div>

    <script>
        function initObsIntegration() {
            if (!window.obsstudio) {
                console.warn('obsstudio API not available (probably not running inside OBS)');

                document.getElementById("overlay_text_wrapper").style.display = "none";
                document.getElementById("overlay_cam").style.display = "none";
                document.getElementById("warning").style.display = "block";
                return;
            }
            
            console.log(window.obsstudio.pluginVersion);

            const overlay_text_wrapper = document.getElementById('overlay_text_wrapper');
            const overlay_text = document.getElementById('overlay_text');
            const overlay_cam = document.getElementById('overlay_cam');
            const particles = document.getElementById('particles-js');

            window.addEventListener('obsTransitionChanged', function(event) {
                const transition_name = event.detail.name
                console.log(transition_name);

                switch (transition_name) {
                    case "Starting_Soon":
                        overlay_text.textContent = "STARTING SOON";
                        break;
                    case "Be_Right_Back":
                        overlay_text.textContent = "BE RIGHT BACK";
                        break;
                    case "Stream_Ending":
                        overlay_text.textContent = "STREAM ENDING";
                        break;
                    case "Show_BG":
                        particles.classList.add('show_background');
                        break;
                    case "Hide_BG":
                        particles.classList.remove('show_background');
                        break;
                    case "Show_Particles":
                        particles.classList.add('opacity');
                        break;
                    case "Hide_Particles":
                        particles.classList.remove('opacity');
                        break;
                    case "Show_Cam":
                        overlay_text_wrapper.classList.add('text_position_top');
                        overlay_cam.classList.add('show_cam');
                        break;
                    case "Hide_Cam":
                        overlay_text_wrapper.classList.remove('text_position_top');
                        overlay_cam.classList.remove('show_cam');
                        break;
                    case "Show_Text":
                        overlay_text.classList.remove('hide_text');
                        break;
                    case "Hide_Text":
                        overlay_text.classList.add('hide_text');
                        break;
                    case "Show_Text_Opacity":
                        overlay_text_wrapper.classList.add('opacity');
                        break;
                    case "Hide_Text_Opacity":
                        overlay_text_wrapper.classList.remove('opacity');
                        break;
                }
            })
        }

        document.addEventListener('DOMContentLoaded', initObsIntegration);
    </script>

    {% include footer.html %}
    <script>
    document.addEventListener("DOMContentLoaded", (e) => {
        setParticles(0.5)
    },!1);
    </script>
  </body>
</html>
